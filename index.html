<!DOCTYPE html>
<html>
<head>
<title>Julian Heuser</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" type="text/css" href="mainStyle.css">
<!-- Templates -->
<template>
		<div class = "shadow"></div>
		<div class = "img_container"><img></div>
		<a href = "#subdivide"><div class = "showcase_text" id = "desc_subdivide">
		<p class = "showcase_heading"></p>
		<p class = "showcase_desc"></p>
		</div></a>
</template>

<template>
	<div class = "box_content">
		<h2 class = "section_header"><span class = "section_textlabel"></span> <a class = "section_showmore">Show all</a></h2>
		<div class = "showcase_row">
		</div>
	</div>
</template>
</head>

<body>
<!-- Header -->
<div class = "outer">
<div class = "wrapper">
	<div class = "header"><h1>Julian Heuser</h1>
		<span class = "links">
			<a href = "https://www.linkedin.com/in/julian-heuser/">LinkedIn</a> |
			<a href = "https://sockman.itch.io/">itch.io</a> |
			<a href = "https://julianheuser.bandcamp.com/">Bandcamp</a> |
			<a href = "https://www.moddb.com/members/sockman1">ModDB</a>
		</span>
	</div>
<!-- About section -->
	<div class = "box_outer">
		<div class = "box_content">
			<h2 class = "section_header">About</h2>
			<p class = "description_text">I'm a current CS student interested in technology, art, and game design. I've worked on numerous programming projects in the past, both with groups and alone. </p>
		</div>
	</div>

	<div class = "box_empty"></div>
<!-- Content (added by javascript) -->
	<span id = "content"></span>

</div>
</div>

<script>
const filterParamName = "filter";
const maxShowcasePerRow = 3;
var urlParams = new URLSearchParams(window.location.search);

//Stuff for mobile devices
var clickElements = document.getElementsByClassName("img_container");
var selectedElement = null;
function setToMobile(){
	for(var i=0; i < clickElements.length; i++) {
		clickElements[i].addEventListener("click", info_show);
		clickElements[i].nextElementSibling.querySelector('.showcase_text').style.pointerEvents = "none";
	}
}

function info_show(event) {
	var clickedElement;

	if(event.target.nodeName == "DIV"){
		clickedElement = event.target.nextElementSibling.querySelector('.showcase_text');
	}
	else{
		clickedElement = event.target.parentElement.nextElementSibling.querySelector('.showcase_text');
	}

	clickedElement.style.pointerEvents = "";
	clickedElement.style.opacity = "1";

	if(selectedElement != null){
		selectedElement.style.pointerEvents = "none"
		selectedElement.style.opacity = "0"
	}
	selectedElement = clickedElement;
}

//Watch if there's any hover input device - if not we do the above code which changes it to click
var mobileQuery = window.matchMedia("(any-hover: none)");
function mobileCheck(x){
	if(x.matches){
		setToMobile();
	}
}

//Template handling
//change privacy.file_unique_origin to false in about:config
//Open XML
var xhttp = new XMLHttpRequest();
xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
    xmlReady(this);
    }
};
xhttp.open("GET", "games.xml", true);
xhttp.send();
var xmlDoc;

function deleteAllSections(){
	//document.getElementById("content").innerHTML = "";
	var content = document.getElementById("content");
	var newContent = document.createElement("span");
	newContent.id = "content";
	content.parentNode.insertBefore(newContent, content.nextSibling);
	content.className = "oldcontent";
	content.id = "";
	console.log(content.clientHeight);
	content.style.maxHeight = (content.clientHeight).toString() + "px";
	setTimeout(function(){ content.classList.add("anim"); }, 10);
	setTimeout(function(){ content.remove(); }, 310);
	setTimeout(function(){
		if(lastSection != ""){
			document.getElementById(lastSection).scrollIntoView({ behavior: "smooth"});
		};
	}, 311);



}

function sectionClick(name){
	window.history.pushState({}, "filter", name);
	dealWithHash();
}

var lastSection = "";

//Creates and displays a section from XML
function displaySection(name, onlyImportant){
	var section = xmlDoc.getElementsByTagName("root")[0].getElementsByTagName(name)[0];

	//Get showcase rows and template
	var rows = document.getElementsByClassName("showcase_row");
	var start = document.getElementById("content");
	var temp_showcase = document.getElementsByTagName("template")[0];
	var temp_section = document.getElementsByTagName("template")[1];


	//Add elements to document
	var showcase;
	if(onlyImportant){
		var showcase = section.querySelectorAll("showcase_important");
	}
	else{
		var showcase = section.querySelectorAll("showcase,showcase_important");
	}

	var outerdiv = document.createElement("div");
	outerdiv.className = "box_outer";
	outerdiv.id = section.tagName;
	var clone = temp_section.content.cloneNode(true);
	outerdiv.appendChild(clone);
	var innerContent = start.appendChild(outerdiv);
	innerContent.getElementsByClassName("section_textlabel")[0].innerHTML = section.tagName;

	if(urlParams.has(filterParamName)){
		innerContent.getElementsByClassName("section_showmore")[0].innerHTML = "Back";
		innerContent.getElementsByClassName("section_showmore")[0].addEventListener('click', function() { sectionClick("?"); }, false);
		lastSection = section.tagName;
	}
	else{
		innerContent.getElementsByClassName("section_showmore")[0].innerHTML = "Show All";
		innerContent.getElementsByClassName("section_showmore")[0].addEventListener('click', function() { sectionClick("?" + filterParamName +"=" + section.tagName); }, false);
	}

	var row = 0;
	var currentRow = innerContent.getElementsByClassName("showcase_row")[0];
	for(var k=0; k < showcase.length; k++) {
		//Handle rows
		row += 1;
		if (row % (maxShowcasePerRow+1) == 0){
			row = 0;
			var div = document.createElement("div")
			div.className = "showcase_row";
			currentRow = innerContent.getElementsByClassName("box_content")[0].appendChild(div);
		}
		//Create showcase element
		var div = document.createElement("div");
		div.className = "showcase";
		var clone = temp_showcase.content.cloneNode(true);
		div.appendChild(clone)
		var element = currentRow.appendChild(div);
		//Set image
		element.querySelector("img").src = showcase[k].getElementsByTagName("img")[0].childNodes[0].nodeValue;
		//Set title/description
		var labels = element.getElementsByTagName("p");
		labels[0].innerHTML = showcase[k].getElementsByTagName("title")[0].childNodes[0].nodeValue;
		labels[1].innerHTML = showcase[k].getElementsByTagName("desc")[0].childNodes[0].nodeValue;
		//Set link
		element.querySelector("a").href = showcase[k].getElementsByTagName("link")[0].childNodes[0].nodeValue;
	}

	var emptyDiv = document.createElement("div");
	emptyDiv.className = "box_empty";
	start.appendChild(emptyDiv);

	mobileCheck(mobileQuery);
}

function displayAllSections(){
	var sections = xmlDoc.getElementsByTagName("root")[0].children;
	for(var i=0; i < sections.length; i++) {
		displaySection(sections[i].tagName, true);
	}
}

//When the hash changes
function dealWithHash(){
	urlParams = new URLSearchParams(window.location.search);
	deleteAllSections();
	if(urlParams.has(filterParamName)){
		var param = urlParams.get(filterParamName);
		displaySection(param, false);
	}
	else{
		displayAllSections();
	}
}

//Called when the XML is ready
function xmlReady(xml, limit) {
  xmlDoc = xml.responseXML;
	var sections = xmlDoc.getElementsByTagName("root")[0].children;
	//Add elements to document
	dealWithHash();
	mobileQuery.addListener(mobileCheck);
}



</script>
</body>
</html>
